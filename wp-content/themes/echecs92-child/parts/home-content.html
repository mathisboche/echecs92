<!-- wp:html -->
<main class="home-main" aria-labelledby="home-hero-title">
  <section class="home-hero" aria-labelledby="home-hero-title">
    <div class="home-hero__inner">
      <h1 id="home-hero-title">Comité d’Échecs des <span class="home-hero__nowrap">Hauts-de-Seine</span></h1>
      <p class="home-hero__lead">Fédérer et développer le jeu d’échecs dans les <span class="home-hero__nowrap">Hauts-de-Seine</span>.</p>
      <div class="home-hero__actions">
        <div class="wp-block-button is-style-fill">
          <a class="wp-block-button__link wp-element-button" href="/clubs">Trouver un club</a>
        </div>
        <div class="wp-block-button is-style-outline home-hero__secondary-button">
          <a class="wp-block-button__link wp-element-button" href="/comite">Le Comité</a>
        </div>
      </div>
    </div>
  </section>

  <section class="home-section home-mission" aria-labelledby="home-mission-title">
    <header class="home-section__header">
      <h2 id="home-mission-title">Notre mission</h2>
      <p>Le CDJE 92 coordonne et structure la pratique des échecs sur le territoire.</p>
    </header>
    <div class="home-mission__grid">
      <article class="home-point">
        <h3>Clubs &amp; territoires</h3>
        <p>Soutien aux clubs, maillage local et accompagnement des dirigeants.</p>
      </article>
      <article class="home-point">
        <h3>Pratique &amp; encadrement</h3>
        <p>Organisation, règlements, arbitrage et cadre compétitif.</p>
      </article>
      <article class="home-point">
        <h3>Jeunes &amp; formation</h3>
        <p>Détection, stages, actions en milieu scolaire et périscolaire.</p>
      </article>
    </div>
  </section>

  <section class="home-section home-figures" aria-labelledby="home-figures-title">
    <header class="home-section__header">
      <h2 id="home-figures-title">Chiffres clés</h2>
    </header>
    <div class="home-figures__grid">
      <article class="home-figure">
        <p class="home-figure__title"><span class="home-figure__number" data-value="20">0</span> clubs affiliés</p>
        <p>Réseau couvrant tout le département.</p>
      </article>
      <article class="home-figure">
        <p class="home-figure__title">
          <span class="home-figure__number" data-value="3401">0</span> licenciés
        </p>
        <p>Pratiquants tous niveaux, jeunes et adultes.</p>
      </article>
      <article class="home-figure">
        <p class="home-figure__title"><span class="home-figure__number" data-value="400" data-prefix="+">0</span> jeunes engagés/an</p>
        <p>Actions en milieu scolaire et périscolaire.</p>
      </article>
      <article class="home-figure">
        <p class="home-figure__title">
          <span class="home-figure__number" data-value="68">0</span> arbitres / formateurs
        </p>
        <p>Encadrement des compétitions.</p>
      </article>
    </div>
  </section>

  <section class="home-section home-cta" aria-label="Accès rapides">
    <div class="home-cta__grid">
      <article class="home-cta__card">
        <h2>Trouver un club</h2>
        <p>Rejoignez un club près de chez vous : initiation, perfectionnement, loisirs ou compétition.</p>
        <div class="wp-block-buttons">
          <div class="wp-block-button is-style-fill">
            <a class="wp-block-button__link wp-element-button" href="/carte-des-clubs">Voir la carte des clubs</a>
          </div>
        </div>
      </article>
      <article class="home-cta__card">
        <h2>Le Comité</h2>
        <p>Instance départementale en lien avec la FFE et la Ligue : missions, gouvernance et coordination des actions dans le 92.</p>
        <div class="wp-block-buttons">
          <div class="wp-block-button is-style-outline">
            <a class="wp-block-button__link wp-element-button" href="/comite">Découvrir le Comité</a>
          </div>
        </div>
      </article>
      <article class="home-cta__card">
        <h2>Contact</h2>
        <p>Une question, un projet, un événement à relayer ?</p>
        <div class="wp-block-buttons">
          <div class="wp-block-button is-style-fill">
            <a class="wp-block-button__link wp-element-button" href="/contact">Nous contacter</a>
          </div>
        </div>
      </article>
    </div>
  </section>
</main>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const counters = document.querySelectorAll('.home-figure__number[data-value]');
    if (!counters.length) return;

    const formatNumber = (value) => value.toLocaleString('fr-FR');
    const setFinalValue = (el) => {
      const target = parseInt(el.dataset.value, 10);
      if (Number.isNaN(target)) return;
      const prefix = el.dataset.prefix || '';
      const suffix = el.dataset.suffix || '';
      el.textContent = `${prefix}${formatNumber(target)}${suffix}`;
    };

    let hasAnimated = false;
    try {
      hasAnimated = window.sessionStorage.getItem('homeMetricsAnimated') === '1';
    } catch (e) {
      hasAnimated = false;
    }

    if (hasAnimated) {
      counters.forEach(setFinalValue);
      return;
    }

    const animate = (el) => {
      const target = parseInt(el.dataset.value, 10);
      if (Number.isNaN(target)) return;
      const prefix = el.dataset.prefix || '';
      const suffix = el.dataset.suffix || '';
      const duration = 1400;
      const start = performance.now();

      const step = (now) => {
        const progress = Math.min((now - start) / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        const current = Math.floor(eased * target);
        el.textContent = `${prefix}${formatNumber(current)}${suffix}`;
        if (progress < 1) {
          requestAnimationFrame(step);
        } else {
          setFinalValue(el);
        }
      };

      requestAnimationFrame(step);
    };

    let animationTriggered = false;
    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          if (!animationTriggered) {
            animationTriggered = true;
            try {
              window.sessionStorage.setItem('homeMetricsAnimated', '1');
            } catch (e) {
              /* ignore sessionStorage issues */
            }
          }
          animate(entry.target);
          obs.unobserve(entry.target);
        }
      });
    }, { threshold: 0.35 });

    counters.forEach((counter) => observer.observe(counter));
  });
</script>
<!-- /wp:html -->
